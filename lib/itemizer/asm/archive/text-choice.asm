PHP
PHA
TYA
PHA
TXA
PHA

LDY #$03
CHECK LDA $D0,Y
CMP *$7F
BEQ REFUSE
DEY
CPY #$00
BNE CHECK

LDA *$7F
ASL A
TAX
LDA $8B82,X
STA *$00
LDA $8B83,X
STA *$01
BNE DONE

REFUSE LDA $9D40
STA *$00
LDA $9D41
STA *$01

DONE PLA
TAX
PLA
TAY
PLA
PLP

RTS